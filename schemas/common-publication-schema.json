{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "Schéma de validation commun pour toutes les publications",
    "type": "object",
    "description": "Propriétés et règles communes à tous les types de publications",
    "definitions": {
      "residenceReference": {
        "type": "string",
        "format": "uuid",
        "description": "GUID de référence d'une résidence"
      },
      "userReference": {
        "type": "string",
        "description": "ID utilisateur (format à définir selon votre système d'auth)"
      },
      "publicationStatus": {
        "type": "string",
        "enum": ["Brouillon", "Publié", "Programmé", "Archivé"],
        "description": "Statuts de base pour toutes les publications"
      },
      "htmlContent": {
        "type": "string",
        "contentType": "text/html",
        "description": "Contenu HTML généré par l'éditeur WYSIWYG"
      }
    },
    "commonProperties": {
      "id": {
        "type": "integer",
        "description": "Identifiant unique auto-généré",
        "minimum": 1
      },
      "targetResidences": {
        "type": "array",
        "description": "Résidences cibles (sécurité critique)",
        "minItems": 1,
        "items": {
          "$ref": "#/definitions/residenceReference"
        }
      },
      "targetResidenceNames": {
        "type": "array",
        "description": "Noms des résidences (affichage)",
        "items": {
          "type": "string"
        }
      },
      "status": {
        "$ref": "#/definitions/publicationStatus"
      },
      "publicationDate": {
        "type": "string",
        "format": "date-time",
        "description": "Date de publication effective"
      },
      "publishLater": {
        "type": "boolean",
        "default": false,
        "description": "Publication programmée"
      },
      "createdAt": {
        "type": "string",
        "format": "date-time",
        "description": "Date de création"
      },
      "createdBy": {
        "$ref": "#/definitions/userReference",
        "description": "Créateur de la publication"
      },
      "updatedAt": {
        "type": "string",
        "format": "date-time",
        "description": "Dernière modification"
      }
    },
    "securityRules": {
      "required": [
        "Multi-résidence : Un utilisateur ne peut publier que dans ses résidences autorisées",
        "Authentification : createdBy doit correspondre à l'utilisateur connecté",
        "Validation : targetResidences doit être validé côté serveur",
        "Audit : Toutes les modifications doivent être tracées"
      ]
    },
    "businessRules": {
      "publication": [
        "Si publishLater=true, publicationDate doit être dans le futur",
        "Un Brouillon peut devenir Publié ou Programmé",
        "Un contenu Publié peut être Archivé",
        "Les transitions de statut doivent être validées"
      ]
    }
  }